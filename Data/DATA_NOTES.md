# Data Notes

## Geospatial Data
###  Point Locations of Sites and Samples
Geospatial data in was created as follows:

1. Data on locations for all *SITES* and *SAMPLE POINTS* from DEP's source data
   were extracted to CSV files using an R script. Multiple *SAMPLE POINTS* are 
   grouped into each *SITE*. 
2. We loaded the CSV files into ArcGIS as tables, and created an event layer
   from the point coordinates included in the CSV files.
3. We exported the  data as feature to geodatabase for further processing.

###  Near Impervious Cover Estimates
Nearby impervious cover estimates (calculated for *SITE* locations) were
based on Maine IF&W one meter pixel impervious cover data, which is based
largely on data from 2007.  CBEP has a version of this impervious cover data for
the Casco Bay watershed towns in our GIS data archives. Analysis followed the
following steps (Some of these steps only speed up analysis). 

1. Town by town IC data in a Data Catalog were assembled into a large `tif` 
   file using the "Mosaic Raster Catalog"  item from the context menu from the
   ArcGIS table of contents.

2. We created a polygon that enclosed all of the Casco Bay sample locations and
   a 1000 meter buffer around each.  Because our version of the Impervious Cover
   layer is limited to Casco Bay Watershed Towns, we can not develop impervious
   cover statistics for sites outside the watershed towns. 

3. We used "Extract by Mask" to extract a smaller version of the impervious
   cover data for just this region.

4. We used "Aggregate" to reduce the resolution of the impervious cover raster
   to a 5 meter resolution, summing the total impervious cover within the
   5m x 5 m area, generating a raster with values from zero to 25. 

5. We used "Focal Statistics" to generate a raster that show the cumulative area
   of impervious cover (in meters) within 500 m. 

6. Finally, we extracted the values of the raster produced in step 4 at
   each of the *SITE* locations.  We used  'Extract  Values to Points'.
   
7. We calculated a "percent imperviousness within 500m" by dividing the raster
   extracted value by the total area of a circle with radius 500m 
   $(\pi \times 500^2)$.
   
8. We exported the resulting attribute table in a (comma delimited) text file 
   `site_500m_imperious_area.txt`.
   
Note that that procedure produces the percent of all area within 500 meters, not
the percent of land area within 500 meters that is impervious.
   
###  `site_500m_imperious_area.txt`.

Column Name  | Contents                                                      
-------------|--------------------------------------------------------
OBJECTID     | Arbitrary code generated by ArcGIS
SITESEQ      | DEP Site Sequence Number
SITECODE     | DEP Caracter code / mnemonic for the site
SITE         | DEP's Site Name
UTM_E        | UTM coordinates, Zone 19 North, WGS1984
UTM_N        | UTM coordinates, Zone 19 North, WGS1984
LAT          | Latitude, WGS 1984, decimal degrees
LONG_        | Longitude, WGS 1984, decimal degrees
RASTERVALU   | Amount of impervious cover within 500m, in square meters
pct_imperv   | Percent impervious cover within 500 meters


## Toxics Data  
### `SWAT_metals_working.csv`
Contains data on concentrations of different metals in blue mussel tissues.

### `SWAT_totals_working.csv`
Includes data on several sums of organic contaminants in blue mussel tissue.

#### Data Format
Both files follow (roughly) the same data format, except that working
concentrations for metals are in micrgrams per gram dry weight, while 


Column Name   | Description
--------------|-----------------------------------------------------------
site_seq      | EGAD sequence number for designated SITE.
sitecode      | Alphanumeric code for a specific SITE.
site          | Name or description of SITE.
year          | Year of sample collection.  Four digit integer.
sample_date   | Date of sample collection.yyyy-mm-ddT00:00:00
sample_id     | Original EGAD sample ID -- NOT unique.
code          | Derived, lengthy alphanumaric code for individual sampling events.
samp_pt_name  | EGAD sample point name. NOT unique. Possibly unique within sites.
lab           | Laboratory conducting analyses.
lab_id        | Internal laboratory sample ID number.
method        | Alphanumeric code for specific laboratory method.
method_name   | Name of method.
parameter     | Name of chemical or physical parameter.
concentration | Value of the parameter.  Usually, but not always a concentration.
units         | Abbreviation of the units used.  Most are SI units of concentration.
lab_qualifier | Laboratory data qualifier. Sometimes caries non-detect flags missing in the next QUALIFIER.
qualifier     | EGAD's `VALIDATION QUALIFIER`.  This is usually a subset of the `LABORATORY QUALIFIER`.
qual_description | Long description of meaning of Validation qualifiers.  Includes some other qualifiers.
rl            | Reporting Limit.  Lab-determined value below which results are non-detects.
mdl           | Method Detection Limit.  Official limit of method.  Usually lower than Reporting Limit.
weight_basis  | Basis for calculating concentration (wet weight, dry weight or lipid weight).
prep_method   | Alphanumeric code for sample preparation methods.
dilution_factor | Dilution factor for sample analysis.  It's not clear whether this is useful.
cas_no        | Chemical Abstract Number for chemical compound or mixture.
conc_ugg      | (metals only) Concentrations, expressed in micrograms per gram (or parts per million).
conc_ngg      | (organics only) Concentrations expressed in nanograms per gram (or parts per billion),
rl_ugg        | (metals only) Reporting limits, expressed in micrograms per gram (or parts per million).
rl_ngg        | (organics only) Reporting limits expressed in nanograms per gram (or parts per billion),
flag	        | Flag indicating a "non-detect"
conc_RL	     | Concentrations data with non-detects replaced by reporting limits
conc_HALF	  | Concentrations data with non-detects replaced by half the reporting limits
conc_ML       | Concentrations data with non-detects replaced by a maximum likelihood estimate of expected value of non-detects based on a longnormal density.

## Reference Levels
Maine DEP compares values of analytic totals to prevalence benchmarks (medians
and 85th percentiles) derived from the Gulfwatch and National Status And trends
monitoring programs, as published by Leblanc et al. 2009.

> Leblanc, L.A., Krahforst, C.F., AubÃ©, J., Roach, S., Brun, G., Harding, G.,
  Hennigar, P., Page, D., Jones, S., Shaw, S., Stahlnecker, J., Schwartz, J.,
  Taylor, D., Thorpe, B., & Wells, P. (2009).  Eighteenth Year of the Gulf of
  Maine Environmental Monitoring Program.

We copied benchmark tables from (an on-line version of) Leblanc et al. 2009 into
our excel spreadsheet, and read those benchmarks in here.

That document also refers to "MCDC Fish Tissue Action Levels." and FDA Action
Levels. After some digging, we found a document on the Maine CDC website that
corresponds to (most or all of) the FTALs reported by DEP.

**ALL HEALTH_RELATED THRESHOLDS ARE EXPRESSED ON A WET WEIGHT BASIS**

>  Maine Center for Disease Control. 2001.  Bureau of Health Fish Tissue Action
   Levels. 
   https://www.maine.gov/dhhs/mecdc/environmental-health/eohp/fish/documents/action-levels-writeup.pdf. 
   Accessed 11/10/2020.


### `Parameter List.xlsx`
This Excel file contains Four Tabs:

1.  "Metals Comparisons" - Potential reference levels for metals, in micrograms 
    per gram dry weight.
    
2.  "Organic Comparisons" - Potential reference levels for total of organic
    contaminants, in nanograms per gram dry weight.
    
3.  "PCB Nomenclature" - A crosswalk between ways of referring to PCBs (here for 
    convenience only).


the Reference levels just described, along with a 
table that indicates 
